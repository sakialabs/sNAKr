# sNAKr–Nimbly Integration Specification (v1)

This document defines the formal, implementation-ready integration between **sNAKr** and **Nimbly**.  
It establishes clear responsibilities, data boundaries, and user-first safeguards while enabling a seamless flow from **household awareness → smart decision → action → learning**.

The specification is intentionally human-first, explainable, platform-agnostic, and safe for shared households.

---

## Purpose

- **sNAKr** answers: *What does the household need, and how urgent is it?*  
- **Nimbly** answers: *When, where, and whether acting now is actually smart.*

Together, they reduce waste, stress, and poor timing decisions without pressure, guilt, or black-box automation.

---

## Core principles

1. **Awareness before action**  
   Needs are detected and explained before any action is proposed.

2. **Explainability over automation**  
   All recommendations include confidence and reasons.

3. **User control is non-negotiable**  
   No purchases or carts occur without explicit confirmation.

4. **Platform neutrality**  
   sNAKr remains neutral. Nimbly evaluates options.

5. **Household-safe design**  
   No blame, no policing, no member-level exposure.

---

## Roles and responsibilities

### sNAKr (Awareness layer)

sNAKr is responsible for:
- Detecting inventory needs
- Estimating urgency and confidence
- Explaining *why* an item is needed
- Producing a clear, human-readable restock intent

sNAKr does not:
- Scan prices or deals
- Recommend stores or platforms
- Optimize checkout
- Trigger purchases

---

### Nimbly (Optimization layer)

Nimbly is responsible for:
- Evaluating timing (buy now vs wait)
- Analyzing prices, deals, and clearances
- Routing to the best platform or store
- Applying soft guardrails (overbuying, poor timing)

Nimbly does not:
- Override sNAKr’s inventory truth
- Invent needs not surfaced by sNAKr
- Auto-purchase without confirmation

---

## Contract artifact: Restock Intent

The handoff from sNAKr to Nimbly is a **Restock Intent**.  
It represents household need, not an order.

### Restock Intent contents

- **Intent metadata**
  - Intent ID
  - Version
  - Household ID
  - Generation timestamp
  - Overall urgency (low, medium, high)

- **Item entries**
  - Canonical item name
  - Category
  - Current fuzzy state (Plenty, OK, Low, Almost out, Out)
  - Confidence score
  - Human-readable reason codes
  - Suggested quantity with confidence

- **Constraints**
  - Partial fulfillment allowed or not
  - Local-first preference (neutral, prefer, required)
  - Budget sensitivity (low, medium, high)

### Guarantees

- Every item includes a confidence score
- Every item includes explainable reasons
- Quantities are suggestions, not requirements
- The intent never implies obligation to buy

---

## Nimbly response: Action Options

Nimbly evaluates a Restock Intent and returns **Action Options**, never commands.

### Action Options may include

- Add items to a cart on a specific platform
- Wait until a suggested time
- Split actions by timing or urgency
- Do nothing

Each option includes:
- Timing recommendation
- Expected benefit (e.g., savings or convenience)
- Confidence level
- Clear reasoning

### Action rules

- Multiple options may be presented
- “Do nothing” is always valid
- Strong recommendations require high confidence
- Low confidence downgrades urgency and tone

---

## User experience ownership

### In sNAKr

- Displays what is needed
- Explains why
- Asks permission to explore options in Nimbly

Example intent prompt:
“Some essentials are running low. Want to see smart options in Nimbly?”

### In Nimbly

- Displays when and where to act
- Explains tradeoffs
- Asks for confirmation before any action

Example confirmation prompt:
“Does this look like a good move?”

---

## Error handling and fallbacks

### If Nimbly is unavailable
- sNAKr remains fully functional
- Restock list remains visible
- Manual export or copy is allowed

### If confidence is low
- Nimbly avoids strong recommendations
- sNAKr softens nudges
- No urgency escalation occurs

---

## Feedback and learning loop

After an action is completed:
1. A receipt is generated by the platform
2. sNAKr ingests the receipt
3. Inventory updates are confirmed
4. Corrections become learning signals
5. Future restock intents improve

Nimbly may receive anonymized success signals and timing effectiveness metrics.  
No user-level behavioral scoring is shared.

---

## Privacy and safety constraints

- No household member attribution
- No cross-app identity leakage
- No surveillance features
- No forced automation
- Explicit opt-in for any future autopilot behavior

---

## Versioning and evolution

- This contract is versioned (v1, v2, etc.)
- Breaking changes require explicit opt-in
- Backward compatibility is maintained for a defined grace period

---

## Explicit non-goals

This specification does not:
- Automate purchases by default
- Lock users into any platform
- Optimize purely for lowest price
- Replace human judgment

---

## Summary

**sNAKr declares need.  
Nimbly evaluates options.  
The user decides.**
